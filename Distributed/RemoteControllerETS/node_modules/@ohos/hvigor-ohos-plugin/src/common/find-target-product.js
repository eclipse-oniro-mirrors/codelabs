"use strict";
/*
 * Copyright (c) Huawei Technologies Co., Ltd. 2021-2022. All rights reserved.
 *
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.findTargetProduct = void 0;
const hvigor_base_1 = require("@ohos/hvigor-base");
const array_util_js_1 = require("../utils/array-util.js");
const ohos_logger_js_1 = require("../utils/log/ohos-logger.js");
const _log = ohos_logger_js_1.OhosLogger.getLogger("find-target-product");
/**
 * 根据命令行中的配置找到根项目下的build-profile.json5中的Product
 *
 * @param projectModuleModel
 */
function findTargetProduct(projectModuleModel) {
    const configProduct = hvigor_base_1.vigorConfigInst.getExtraConfig().get("product");
    // 没有配置时默认是default
    const targetProduct = configProduct ? configProduct : "default";
    _log.debug(`Find product from build-profile.json: %s`, targetProduct);
    // 检查app中是否有该product
    const mProduct = (0, array_util_js_1.getElementFromArr)(projectModuleModel.getProfileOpt().app.products, targetProduct);
    if (!mProduct) {
        _log._buildError(`Can not find product ${targetProduct}, please check!`)
            ._solution('Please check attribute products from build-profile.json5.')
            ._file(projectModuleModel.getProfilePath())
            ._printErrorAndExit(projectModuleModel.getName());
    }
    return mProduct;
}
exports.findTargetProduct = findTargetProduct;
//# sourceMappingURL=find-target-product.js.map