"use strict";
/*
 * Copyright (c) Huawei Technologies Co., Ltd. 2021-2022. All rights reserved.
 *
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.ModuleModelImpl = void 0;
const target_source_set_impl_js_1 = require("../source-set/target-source-set-impl.js");
const path_1 = __importDefault(require("path"));
const module_type_enum_js_1 = require("../../enum/module-type-enum.js");
const core_module_model_impl_js_1 = require("./core-module-model-impl.js");
const common_const_js_1 = require("../../const/common-const.js");
const defaultTargetName = common_const_js_1.DefaultTargetConst.DEFAULT_TARGET;
/**
 * hvigor 工程的module模块的数据管理对象
 *
 * @since 2022/2/23
 */
class ModuleModelImpl extends core_module_model_impl_js_1.CoreModuleModelImpl {
    constructor(modulePath, moduleName, parentProject) {
        super(modulePath, moduleName, parentProject);
        this.initDefaultTargetSourceSet();
    }
    initDefaultTargetSourceSet() {
        // 初始化创建default的target sourceSet
        const defaultTargetSourceSet = new target_source_set_impl_js_1.TargetSourceSetImpl(path_1.default.resolve(this._sourceRootDir, "main"));
        this.targetSourceSetMap.set(defaultTargetName, defaultTargetSourceSet);
        const ohosTestTargetSourceSet = new target_source_set_impl_js_1.TargetSourceSetImpl(path_1.default.resolve(this._sourceRootDir, "ohosTest"));
        this.targetSourceSetMap.set(common_const_js_1.DefaultTargetConst.OHOS_TEST_TARGET, ohosTestTargetSourceSet);
    }
    getModuleType() {
        const targetSourceSetImpl = this.getSourceSetByTargetName();
        const moduleTypeStr = targetSourceSetImpl.getModuleTargetRes().getModuleJsonOpt().module.type;
        return module_type_enum_js_1.ModuleType.valueOf(moduleTypeStr);
    }
    getSourceSetByTargetName(targetName = defaultTargetName) {
        if (this.targetSourceSetMap.has(targetName)) {
            return this.targetSourceSetMap.get(targetName);
        }
        return this.targetSourceSetMap.get(defaultTargetName);
    }
    getJsonObjByTargetName(targetName) {
        return this.getSourceSetByTargetName(targetName).getModuleTargetRes().getModuleJsonOpt();
    }
}
exports.ModuleModelImpl = ModuleModelImpl;
//# sourceMappingURL=module-model-impl.js.map