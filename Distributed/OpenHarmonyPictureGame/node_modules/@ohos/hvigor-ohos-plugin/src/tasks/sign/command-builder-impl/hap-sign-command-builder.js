"use strict";
/*
 * Copyright (c) Huawei Technologies Co., Ltd. 2022-2022. All rights reserved.
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.HapSignCommandBuilder = void 0;
const common_sign_command_builder_1 = require("./common-sign-command-builder");
const sdk_const_1 = require("../../../const/sdk-const");
const path_1 = __importDefault(require("path"));
/**
 * sdk 新签名工具hap-sign-tool的命令行生成器
 *
 * @since 2022/03/01
 */
class HapSignCommandBuilder extends common_sign_command_builder_1.CommonSignCommandBuilder {
    constructor(projectModel, signingConfig, sdkInfo, signModel, signingOptions) {
        super(projectModel, signingConfig, sdkInfo, signModel, signingOptions);
    }
    getSignTool() {
        return path_1.default.resolve(this._sdkInfo.getSignDir(), sdk_const_1.ToolChainsConst.NEW_SIGN_TOOL);
    }
    /**
     * 获取build-profile中的签名配置,加载到signOptions中
     */
    initCommandParams() {
        const material = this._signingConfig.material;
        this.checkValidMaterial(material);
        this._signingOptions.sign()
            .addMode(HapSignCommandBuilder.SIGN_MODE)
            .addKeyStoreFile(material.storeFile)
            .addKeyStorePwd(this.getKeyStorePwd())
            .addKeyAlias(material.keyAlias)
            .addKeyPwd(this.getKeyPwd())
            .addSignAlg(material.signAlg)
            .addProfileFile(material.profile)
            .addAppCertFile(material.certpath)
            .addInputFile(this._signModel.getInputFilePath())
            .addOutputFile(this._signModel.getOutPutFilePath());
    }
}
exports.HapSignCommandBuilder = HapSignCommandBuilder;
HapSignCommandBuilder.SIGN_MODE = "localSign";
//# sourceMappingURL=hap-sign-command-builder.js.map